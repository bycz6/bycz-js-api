<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Steem.js</title>
</head>
<body>
<script src="//cdn.steemjs.com/lib/latest/steem.min.js"></script>

<p>Repostas aos comentários do post xpto</p>


Link registo: <input type="text" id ="link" name="Link"><br>
<input id="clickMe" type="button" value="Player registered" onclick="init_regist();" />

<p> Links uteis </p>
<p> https://steemit.com/steem-pocalypse/@papa-pepper/steem-pocalypse-survival-game-contest-season-4-sign-up-100-sbd-already-in-the-prize-pool </p>

<p id="initest"></p>

<ul id="result2"></ul>



<script>

<!--lista dos jogadores inscritos-->
var ul = document.getElementById('result2');
var author = "";
var permlink = "";

<!-- Funções -->

<!-- construtor jogador -->
function player(name,team, life, money, resources){
        this.team = null; <!-- if null solo player; else is name of the team -->
	this.name = name; <!-- lista de nomes jogadore(s)  -->
        this.life = life;
        this.money = money;
        this.resources = resources; <!-- lista de  armas + utensilios  -->
}

<!-- verificar todos os comentários e sub-comentários recursivamente e submete os utilizadores para inscrição -->
function ver_users_replies(author, link){
	steem.api.getContentReplies(author, link, function(err, result) {
        console.log(err, result);
	
		if(result.length > 0){
			for (x = 0  ; x < result.length ; x++){
                   		register_player(result[x].author);
				ver_users_replies(result[x].author,result[x].permlink);		
			}
		}


	});
}

<!-- regista os jogadores e garante que não há repetidos -->
function register_player(username){
	
	var li = document.createElement('li');
	li.innerHTML = username;
	ul.appendChild(li);

}

<!-- extrai do link do artigo o autor e o permlink-->
function parse_link(link){
	var at = link.indexOf("@");
	var p = link.substring(at,at.length);

	var slash = p.indexOf("/");
	author = p.substring(1,slash);
	permlink = p.substring(slash+1 , p.length); 
	
	<!-- ver_users_replies(author,permlink);-->

}

<!-- inicia o registo dos jogadores-->
function init_regist(){

parse_link(document.getElementById('link').value);

if(ver_date(1)){	
	ver_users_replies(author,permlink);
	console.log("Ai vamnos nós!!!!");
}else{
console.log("Ainda não passaram as 24h da inscrição!");
}


}

<!-- verifica se o artigo foi criado à mais horas do que as passadas em atributo-->
function ver_date(time){
	steem.api.getContent(author, permlink, function(err, result) {
		console.log(err, result);
		
		var release_time = new Date(); 		
		console.log("post time: " + result.created);
		console.log("release time: " + release_time);
		https://steemit.com/steem-pocalypse/@papa-pepper/steem-pocalypse-survival-game-contest-season-4-sign-up-100-sbd-already-in-the-prize-pool
		if (result.created > new Date()-time){
		return true;
		}
	return false;	
	});
}

</script>


</body>
</html>
